# 模型

很多的预测算法，都需要预先训练模型，为了保证模型的持续演进，
还需要考虑模型的持续更新和AB效果。

### 离线任务模型

用于管理模型的离线计算，需要数据的输入，考虑到数据输入有冷启动
的情况，需要具备计算过程上下文保存的能力

- 创建：创建离线任务
- 启动：把离线任务启动
- 查询：查询离线任务的状态
- 暂停：把上下文保存起来

### 实时任务模型

实时模型，往往需要验证后再上线，考虑实现回测框架，以及风控系统，保证实时模型的正常运行

# 接口

对外提供两种接口，batch & stream

### 流式接口

流式接口的计算用于对需要实时计算（如行为预测）场景进行计算，
接口通过消息队列接收信息，计算出结果后，推送到消息队列中发布
出去，客户端可以通过http/websocket等多种方式，在前端服务器
获取结果。

### 批量请求接口

批量请求接口用于客户端收集了足够的信息后，一次性往服务器推送
上下文的所有信息，预测下一步的结果。

批量请求接口需要模型经过计算，并且有测试结果后，才可以正常工作，
请求接口应该包含该部分逻辑的描述。

考虑以下方式的接口：
- 图片识别
  - 图片识别数据提交接口
    - 数据
    - 分类结果
  - 图片识别结果接口
    - 提交：数据
    - 返回：分类real
- 识别年龄
- 对象检测
- 名片格式化

# 数据

对数据源的抽象定义，提供字段和接口（？可以考虑使用spark.DataFrame）

### 如何建立模型

系统需要用户输入特征，输入希望预测的结果，因需要用户参与，
需考虑提供用户咨询服务，避免用户陷入困惑

- 用户选择希望预测的结果
- 用户挑选输入的数据
- 启动模型训练，获得模型的评估量度
- 模型上线，启动模型服务

### 消息定义

/where/who/when/what/how/why
/厂家/业务/{服|区域}/用户/行为{购买|点击|...}/参数/上下文

如何处理第三方数据更新？
/厂家/业务/商品/行为{添加|更新}/参数

### 数据例子

| user | action1     | action2       | action3     |
|------|-------------|---------------|-------------|
|user1 | login:time  | buy:item1     | award:item7 |
|user2 | login:time  | buy:item3     |   .....     |

| item   | cost  | type  |
|--------|-------|-------|
| item1  | cost1 | type3 |

### 数据常用格式

配合Restful的流行，json被广泛采用

### 消息保存

适应用户弹性格式存储需求？

- 如何提取参数内容：用户自定义参数
- 如何提取上下文：用户自定义参数

### 结果预测

- /厂家/业务/{服|区域}/用户/行为模型/参数 => 结果
- 用户真实行为结果记录
- 后台离线服务持续计算效果？？跟踪模型的效率？
